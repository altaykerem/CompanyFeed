<!DOCTYPE html>
  <html>
  	<head>
  		<meta charset="utf-8">
  		<meta http-equiv="X-UA-Compatible" content="IE=edge">
  		<meta name="viewport" content="width=device-width, initial-scale=1">
  		<title>Company Digest</title>
      <!-- Firebase -->
      <script src="https://www.gstatic.com/firebasejs/5.2.0/firebase.js"></script>
      <script src="https://www.gstatic.com/firebasejs/5.2.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/5.2.0/firebase-firestore.js"></script>
  
  		<!-- Bootstrap CSS -->
  		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  		<!-- Google Fonts -->
  		<link href='https://fonts.googleapis.com/css?family=Poppins:400,300,500,600,700' rel='stylesheet' type='text/css'>

      <!-- Style -->
      <link href='style.css' rel='stylesheet' type='text/css'>
  
      <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
      <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
      <![endif]-->
  	</head>
  	<body>
  		<nav class="navbar navbar-default" role="navigation">
  			<div class="container">
  				<!-- Brand and toggle get grouped for better mobile display -->
  				<div class="navbar-header">
  					<a class="navbar-brand" href="http://www.maxitech.com/">MAXITECH</a>
  				</div>
  			</div>
  		</nav>
		
		<!-- START SECTION -->
  		<div class="section text-center  background-dark dark-bg">
  			<div class="background-image" style="background: url(bosphorus.jpg) no-repeat center center; background-size: cover; opacity: .2;"></div>
  			<div class="container">
  				<div class="row">
  					<div class="col-md-12">
  						<h2 class="section-title">Query Control</h2>
              <p class="section-description">Design your search parameters for the best fit</p>
              <p>Notes</p>
              <p>Already developed companies have high growth score, an upper bound might shift the focus to developing companies</p>
              <p>Momentum is the weekly change in growth</p>
  					</div>
  				</div>
  			</div>
  		</div>
  		<!--/.section -->

  		<!-- START SECTION -->
  		<div class="section">
  			<div class="container">
  				<div class="row">
  					<div class="col-md-12 text-center">
  						<h2 class="section-title">Parameters</h2>
  					</div>
  					<div class="col-md-8 col-md-offset-2">
  						<form id="params" name="params" method="post" class="form" role="form">
  							<div class="row">
                  <div class="col-md-4">
                    <p class="text-center">Date</p>
                  </div>
				<div class="col-md-4 form-group">
					<input class="form-control" id="time" name="time" placeholder="time" type="text" />
				</div>
				<div class="col-md-4 form-group">
					<input class="form-control" id="day" name="day" placeholder="day" type="text" />
				</div>
				</div>

                <div class="row">
                  <div class="col-md-4">
                    <p class="text-center">Momentum</p>
                  </div>
                  <div class="col-md-8 form-group">
                    <input class="form-control" id="momentumMin" name="momentumMin" placeholder="min" type="text" />
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-4">
                    <p class="text-center">Growth Score</p>
                  </div>
                  <div class="col-md-4 form-group">
                    <input class="form-control" id="growthMin" name="growthMin" placeholder="min" type="text" />
                  </div>
                  <div class="col-md-4 form-group">
                    <input class="form-control" id="growthMax" name="growthMax" placeholder="max" type="text" />
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-4">
                    <p class="text-center">Page Size</p>
                  </div>
                  <div class="col-md-8 form-group">
                    <input class="form-control" id="query-size" name="criteria" value="10" type="text" />
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-4">
                    <p class="text-center">Sort</p>
                  </div>
                  <div class="col-md-4 form-group">
                    <input class="form-control" id="criteria" name="criteria" value="funding date" type="text" />
                  </div>
                  <div class="col-md-4 form-group">
                    <input class="form-control" id="direction" name="direction" value="desc" type="text" />
                  </div>
                </div>

					<div class="row">
						<div class="col-md-2 text-center form-group">
							<h2 onclick="adjustFilters()">Submit</h2>
						</div>
					</div>
  						</form>
  					</div>
  				</div><!--/.row-->
  			</div><!--/.container-->
  		</div>
  		<!--/.section -->
      <!-- functions -->
      <script>
        function adjustFilters(){
        	window.alert("Button");
            // Initialize Firebase
            var config = {
                apiKey: process.env.firebase_web_api,
                authDomain: "company-feed.firebaseapp.com",
                databaseURL: "https://company-feed.firebaseio.com",
                projectId: "company-feed",
                storageBucket: "company-feed.appspot.com",
                messagingSenderId: "115430820745"
            };
            window.alert("API");
            firebase.initializeApp(config);
            var db = firebase.firestore();

            var updateObject = {};

            if (validateField("time")) {
                updateObject.time = document.forms["params"]["time"].value;
            }
            if (validateField("day")) {
                updateObject.day = document.forms["params"]["day"].value;
            }
            if (validateField("momentumMin")) {
                updateObject.momentumMin = Number(document.forms["params"]["momentumMin"].value);
            }
            if (validateField("growthMin")) {
                updateObject.growthMin = Number(document.forms["params"]["growthMin"].value);
            }
            if (validateField("growthMax")) {
                updateObject.growthMax = Number(document.forms["params"]["growthMax"].value);
            }
            if (validateField("criteria")) {
                updateObject.criteria = document.forms["params"]["criteria"].value;
            }
            if (validateField("direction")) {
                updateObject.sort = document.forms["params"]["direction"].value;
            }
            if (validateField("query-size")) {
                updateObject.pageSize = document.forms["params"]["query-size"].value;
            }            

            db.collection("runtime").doc("parameters").set(updateObject, { merge: true })
            .then(function(docRef) {
                console.log("Document written with ID: ", docRef.id);
            })
            .catch(function(error) {
                console.error("Error adding document: ", error);
            });

            window.alert("Parameters changed");
        }

        function validateField(param){
            if (document.forms["params"][param].value != "") {
              return true;
            }
            return false;
        }
      </script>
  		<!-- jQuery -->
  		<script src="//code.jquery.com/jquery.js"></script>
  		<!-- Bootstrap JavaScript -->
  		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  	</body>
  </html>